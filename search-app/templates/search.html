{% extends "layout.html" %}
{% block content %}
<!-- Container Info-->
<small class="container-info"><p><b>▻ Search Results</b> for: [ {{ query }} ]
</small>

  <hr>
  <!-- Search Result Arguments-->
  {% for s in search_results %}     <!-- After adjusting the system.py regarding the data fields you might need to adapt the displayed data fields here (e.g. s.title, s.argument, ...)-->
        <article class="media content-section" id="result-{{ loop.index }}" result_rank="{{ loop.index }}" base_ir="{{ s.docid }}">
        <div class="media-body">
          <!-- Title -->
          <h4>
            <span>{{ loop.index + 10*(page-1) }}. {{ s.title }}</span>
          </h4>

              

              <!-- Argument preview -->
              <p class="article-content" id="abstract-preview-{{ loop.index }}">
                {{ s.argument[:200] }}...                                              
              </p>

              <!-- Full abstract (initially hidden) -->
              <p class="article-content d-none" id="abstract-full-{{ loop.index }}">
                {{ s.argument }}
              </p>

              <!-- Expand/Collapse Control -->
              <div class="toggle-abstract" data-index="{{ loop.index }}" data-rank="{{loop.index + 10*(page-1)}}" did = {{s.docid}} style="cursor: pointer; color: #007bff; user-select: none;">
                <span id="arrow-{{ loop.index }}">▼</span> <span id="toggle-label-{{ loop.index }}">Expand</span>
              </div>

              <div style="display: flex; justify-content: flex-end; gap: 0.5em; margin-top: 0.5em;" id="buttons-{{ loop.index }}">
                <button type="button"
                        data-type="pro"
                        class="btn btn-outline-success btn-no-focus"
                        data-index="{{ loop.index }}"
                        data-rank="{{loop.index + 10*(page-1)}}"
                        did = {{s.docid}}
                        onclick="toggleArgument('{{ s.docid }}', 'pro')"
                        id="pro-btn-{{ s.docid }}">
                  Pro                                                      <!-- Change button label here --> 
                </button>

                <button type="button"
                        data-type="con"
                        class="btn btn-outline-danger btn-no-focus"
                        data-index="{{ loop.index }}"
                        data-rank="{{loop.index + 10*(page-1)}}"
                        did = {{s.docid}}
                        onclick="toggleArgument('{{ s.docid }}', 'con')"
                        id="con-btn-{{ s.docid }}">
                Con                                                        <!-- Change button label here -->
                </button>
              </div>


          <!-- Date + DocID -->
          <div class="article-metadata" style="display: flex; justify-content: space-between;" id="metadata-{{ loop.index }}_l">
            <small class="text-muted">{{ s.source_title }}</small>
            <!--<small class="text-muted">{{ s.date }}</small>   // mostly no existing date-->
          </div>
        </div>
      </article>
  {% endfor %}
  
  {% if total_pages > 1 %}
  <nav aria-label="Page navigation" class="mt-4">
    <ul class="pagination justify-content-center">

      <!-- Previous -->
      <li class="page-item {% if page == 1 %}disabled{% endif %}">
        <a class="page-link" href="{{ url_for('result', query=query, page=page-1) }}" tabindex="-1">« Previous</a>
      </li>

      <!-- Page Numbers -->
      {% for p in range(1, total_pages + 1) %}
      <li class="page-item {% if page == p %}active{% endif %}">
        <a class="page-link" href="{{ url_for('result', query=query, page=p) }}">{{ p }}</a>
      </li>
      {% endfor %}

      <!-- Next -->
      <li class="page-item {% if page == total_pages %}disabled{% endif %}">
        <a class="page-link" href="{{ url_for('result', query=query, page=page+1) }}">Next »</a>
      </li>

    </ul>
  </nav>
  {% endif %}

{% endblock  content%}
